<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dsw">
<title>Fixed Effects • dsw</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fixed Effects">
<meta property="og:description" content="dsw">
<meta property="og:image" content="https://debruine.github.io/data-sim-workshops/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dsw</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9007</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calories.html">Calorie Placement Re-Simulation</a>
    <a class="dropdown-item" href="../articles/faux.html">Intro to Faux</a>
    <a class="dropdown-item" href="../articles/fixed.html">Fixed Effects</a>
    <a class="dropdown-item" href="../articles/mixed.html">Mixed Effects</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/debruine/data-sim-workshops/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fixed Effects</h1>
                        <h4 data-toc-skip class="author">Lisa
DeBruine</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/debruine/data-sim-workshops/blob/HEAD/vignettes/fixed.Rmd" class="external-link"><code>vignettes/fixed.Rmd</code></a></small>
      <div class="d-none name"><code>fixed.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/debruine/faux" class="external-link">faux</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://afex.singmann.science/" class="external-link">afex</a></span><span class="op">)</span> <span class="co"># for anova and lmer</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/broom.mixed" class="external-link">broom.mixed</a></span><span class="op">)</span> <span class="co"># to make tidy tables of lmer output</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="simulation-functions">Simulation functions<a class="anchor" aria-label="anchor" href="#simulation-functions"></a>
</h2>
<p>The functions below are commonly used when you’re setting up a
simulated dataset.</p>
<div class="section level3">
<h3 id="repeating">Repeating<a class="anchor" aria-label="anchor" href="#repeating"></a>
</h3>
<p>The function <code><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep()</a></code> lets you repeat the first argument a
number of times.</p>
<p>Use <code><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep()</a></code> to create a vector of alternating
<code>"A"</code> and <code>"B"</code> values of length 24.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">##  [1] "A" "B" "A" "B" "A" "B" "A" "B" "A" "B" "A" "B" "A" "B" "A" "B" "A" "B" "A"</span></span>
<span><span class="co">## [20] "B" "A" "B" "A" "B"</span></span></code></pre></div>
<p>If the second argument is a vector that is the same length as the
first argument, each element in the first vector is repeated that many
times. Use <code><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep()</a></code> to create a vector of 11 <code>"A"</code>
values followed by 3 <code>"B"</code> values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##  [1] "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "B" "B" "B"</span></span></code></pre></div>
<p>You can repeat each element of the vector a specified number of times
using the <code>each</code> argument, Use <code><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep()</a></code> to create a
vector of 12 <code>"A"</code> values followed by 12 <code>"B"</code>
values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">##  [1] "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "A" "B" "B" "B" "B" "B" "B" "B"</span></span>
<span><span class="co">## [20] "B" "B" "B" "B" "B"</span></span></code></pre></div>
<p>What do you think will happen if you set <code>times</code> to 3 and
<code>each</code> to 2?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">3</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">##  [1] "A" "A" "B" "B" "A" "A" "B" "B" "A" "A" "B" "B"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sequences">Sequences<a class="anchor" aria-label="anchor" href="#sequences"></a>
</h3>
<p>The function <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code> is useful for generating a sequence
of numbers with some pattern.</p>
<p>Use <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code> to create a vector of the integers 0 to
10.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">##  [1]  0  1  2  3  4  5  6  7  8  9 10</span></span></code></pre></div>
<p>You can set the <code>by</code> argument to count by numbers other
than 1 (the default). Use <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code> to create a vector of the
numbers 0 to 100 by 10s.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">##  [1]   0  10  20  30  40  50  60  70  80  90 100</span></span></code></pre></div>
<p>The argument <code>length.out</code> is useful if you know how many
steps you want to divide something into. Use <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code> to
create a vector that starts with 0, ends with 100, and has 12 equally
spaced steps (hint: how many numbers would be in a vector with 2
<em>steps</em>?).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, length.out <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span>
<span><span class="co">##  [1]   0.000000   8.333333  16.666667  25.000000  33.333333  41.666667</span></span>
<span><span class="co">##  [7]  50.000000  58.333333  66.666667  75.000000  83.333333  91.666667</span></span>
<span><span class="co">## [13] 100.000000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="uniform-distribution">Uniform Distribution<a class="anchor" aria-label="anchor" href="#uniform-distribution"></a>
</h3>
<p>The uniform distribution is the simplest distribution. All numbers in
the range have an equal probability of being sampled. Use
<code><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif()</a></code> to sample from a continuous uniform
distribution.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">##  [1] 0.1594836 0.4781883 0.7647987 0.7696877 0.2685485 0.6730459 0.9787908</span></span>
<span><span class="co">##  [8] 0.8463270 0.8566562 0.4451601</span></span></code></pre></div>
<p>Pipe the result to <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code> to make a quick histogram of
your simulated data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100000</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="fixed_files/figure-html/runif-hist-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="discrete-distribution">Discrete Distribution<a class="anchor" aria-label="anchor" href="#discrete-distribution"></a>
</h3>
<p>You can use <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample()</a></code> to simulate events like rolling
dice or choosing from a deck of cards. The code below simulates rolling
a 6-sided die 10000 times. We set <code>replace</code> to
<code>TRUE</code> so that each event is independent. See what happens if
you set <code>replace</code> to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rolls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">rolls</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="fixed_files/figure-html/sample-replace-1.png" alt="Distribution of dice rolls." width="100%"><p class="caption">
Distribution of dice rolls.
</p>
</div>
<p>You can also use sample to sample from a list of named outcomes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pet_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span>, <span class="st">"bird"</span>, <span class="st">"fish"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">pet_types</span>, <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">##  [1] "dog"    "fish"   "cat"    "fish"   "bird"   "bird"   "fish"   "ferret"</span></span>
<span><span class="co">##  [9] "ferret" "bird"</span></span></code></pre></div>
<p>Ferrets, while the best pet, are a much less common pet than cats and
dogs, so our sample isn’t very realistic. You can set the probabilities
of each item in the list with the <code>prob</code> argument.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pet_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span>, <span class="st">"bird"</span>, <span class="st">"fish"</span><span class="op">)</span></span>
<span><span class="va">pet_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">pet_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">pet_types</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="va">pet_prob</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">pet_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="fixed_files/figure-html/sample-prob-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="binomial-distribution">Binomial Distribution<a class="anchor" aria-label="anchor" href="#binomial-distribution"></a>
</h3>
<p>The <code>rbinom</code> function will generate a random binomial
distribution.</p>
<ul>
<li>
<code>n</code> = number of observations</li>
<li>
<code>size</code> = number of trials</li>
<li>
<code>prob</code> = probability of success on each trial</li>
</ul>
<p>Coin flips are a typical example of a binomial distribution, where we
can assign heads to 1 and tails to 0.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 20 individual coin flips of a fair coin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">##  [1] 0 1 1 0 0 0 1 0 1 0 0 0 0 1 0 1 0 0 0 1</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 20 individual coin flips of a baised (0.75) coin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1</span>, <span class="fl">0.75</span><span class="op">)</span></span>
<span><span class="co">##  [1] 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 0 1</span></span></code></pre></div>
<p>You can generate the total number of heads in 1 set of 20 coin flips
by setting <code>size</code> to 20 and <code>n</code> to 1.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1 set of 20 fair coin flips</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span>, <span class="fl">0.75</span><span class="op">)</span></span>
<span><span class="co">## [1] 13</span></span></code></pre></div>
<p>You can generate more sets of 20 coin flips by increasing the
<code>n</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 10 sets of 20 fair coin flips</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">##  [1] 12  7 10 11 11  8 11  7 12  8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="normal-distribution">Normal Distribution<a class="anchor" aria-label="anchor" href="#normal-distribution"></a>
</h3>
<p>We can simulate a normal distribution of size <code>n</code> if we
know the <code>mean</code> and standard deviation (<code>sd</code>).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 10 samples from a normal distribution with a mean of 0 and SD of 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">##  [1] -0.3230057  0.7213149  0.4248971  1.4033239 -0.6881243 -0.2737261</span></span>
<span><span class="co">##  [7] -0.1539815 -0.3908546 -0.3301087  1.7890306</span></span></code></pre></div>
<p>A density plot is usually the best way to visualise this type of
data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 100 samples from a normal distribution with a mean of 10 and SD of 2</span></span>
<span><span class="va">dv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use sample to get a random colour</span></span>
<span><span class="va">fill_colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colours</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">dv</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">fill_colour</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span>, </span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="fixed_files/figure-html/rnorm-plot-1.png" width="100%"></p>
<p>Run the simulation above several times, noting how the density plot
changes. Try changing the values of <code>n</code>, <code>mean</code>,
and <code>sd</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="independent-samples">Independent samples<a class="anchor" aria-label="anchor" href="#independent-samples"></a>
</h2>
<p>Now we’re ready to start simulating some data. Let’s start with a
simple independent-samples design where the variables are from a normal
distribution. Each subject produces one score (in condition A or B).
What we need to know about these scores is:</p>
<ul>
<li>How many subjects are in each condition?</li>
<li>What are the score means?</li>
<li>What are the score variances (or SDs)?</li>
</ul>
<div class="section level3">
<h3 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>First, set parameters for these values. This way, you can use these
variables wherever you need them in the rest of the code and you can
easily change them.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">A_sub_n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">B_sub_n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">A_mean</span>  <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">B_mean</span>  <span class="op">&lt;-</span> <span class="fl">11</span></span>
<span><span class="va">A_sd</span>    <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">B_sd</span>    <span class="op">&lt;-</span> <span class="fl">2.5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="scores">Scores<a class="anchor" aria-label="anchor" href="#scores"></a>
</h3>
<p>We can the generate the scores using the <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm()</a></code>
function.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">A_sub_n</span>, <span class="va">A_mean</span>, <span class="va">A_sd</span><span class="op">)</span></span>
<span><span class="va">B_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">B_sub_n</span>, <span class="va">B_mean</span>, <span class="va">B_sd</span><span class="op">)</span></span></code></pre></div>
<p>You can stop here and just analyse your simulated data with
<code>t.test(A_scores, B_scores)</code>, but usually you want to get
your simulated data into a data table that looks like what you might
eventually import from a CSV file with your actual experimental
data.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  sub_condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_sub_n</span>, <span class="va">B_sub_n</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>  score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_scores</span>, <span class="va">B_scores</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If you’re simulating data for a script where you will eventually
import data from a csv file, you can save these data to a csv file and
then re-read them in, so when you get your real data, all you need to do
is comment out the simulation steps.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make a data directory if there isn't one already</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save your simulated data</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">"data/sim-data-ind-samples.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># start your analysis here</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"data/sim-data-ind-samples.csv"</span><span class="op">)</span></span>
<span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">100</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span> (1): sub_condition</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (1): score</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-your-data">Check your data<a class="anchor" aria-label="anchor" href="#check-your-data"></a>
</h3>
<p>Always examine your simulated data after you generate it to make sure
it looks like you want.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sub_condition</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> ,</span>
<span>            mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span>,</span>
<span>            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">##   sub_condition     n  mean    sd</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> A                50  10.3  2.54</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> B                50  10.8  2.38</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">score</span><span class="op">~</span><span class="va">sub_condition</span>, <span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Welch Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  score by sub_condition</span></span>
<span><span class="co">## t = -0.99215, df = 97.577, p-value = 0.3236</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group A and group B is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -1.4645314  0.4882661</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean in group A mean in group B </span></span>
<span><span class="co">##        10.31599        10.80412</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="function">Function<a class="anchor" aria-label="anchor" href="#function"></a>
</h3>
<p>You can wrap all this in a function so you can run it many times to
do a power calculation. Put all your parameters as arguments to the
function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ind_sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">A_sub_n</span>, <span class="va">B_sub_n</span>, </span>
<span>                    <span class="va">A_mean</span>, <span class="va">B_mean</span>, </span>
<span>                    <span class="va">A_sd</span>, <span class="va">B_sd</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># simulate data for groups A and B</span></span>
<span>  <span class="va">A_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">A_sub_n</span>, <span class="va">A_mean</span>, <span class="va">A_sd</span><span class="op">)</span></span>
<span>  <span class="va">B_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">B_sub_n</span>, <span class="va">B_mean</span>, <span class="va">B_sd</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># put the data into a table</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    sub_condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_sub_n</span>, <span class="va">B_sub_n</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_scores</span>, <span class="va">B_scores</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># analyse the data</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">score</span><span class="op">~</span><span class="va">sub_condition</span>, <span class="va">dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># return a list of the values you care about</span></span>
<span>  <span class="co"># the double brackets ([[]]) get rid of the name of named numbers</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    t <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">statistic</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    ci_lower <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    ci_upper <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    p <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">p.value</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    estimate <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">t</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now run your new function with the values you used above.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># str() prints the resulting list in a shorter format</span></span>
<span><span class="fu">ind_sim</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## List of 5</span></span>
<span><span class="co">##  $ t       : num -2.18</span></span>
<span><span class="co">##  $ ci_lower: num -2.11</span></span>
<span><span class="co">##  $ ci_upper: num -0.101</span></span>
<span><span class="co">##  $ p       : num 0.0314</span></span>
<span><span class="co">##  $ estimate: num -1.1</span></span></code></pre></div>
<p>Now you can use this function to run many simulations. The function
<code>map_df</code> from the <code>purrr</code> package (loaded with
<code>tidyverse</code>) is one of many ways to run a function many times
and organise the results into a table.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mysim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">~</span><span class="fu">ind_sim</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now you can graph the data from your simulations.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set boundary = 0 when plotting p-values</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mysim</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.05</span>, boundary <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fixed_files/figure-html/sim-p-fig-1.png" width="100%"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mysim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">stat</span>, <span class="va">value</span>, <span class="va">t</span><span class="op">:</span><span class="va">estimate</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">value</span>, color <span class="op">=</span> <span class="va">stat</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">stat</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="fixed_files/figure-html/ind-sim-fig-1.png" alt="Distribution of results from simulated independent samples data" width="100%"><p class="caption">
Distribution of results from simulated independent samples data
</p>
</div>
<p>You can calculate power as the proportion of simulations on which the
p-value was less than your alpha.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mysim</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="va">power</span></span>
<span><span class="co">## [1] 0.474</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="paired-samples">Paired samples<a class="anchor" aria-label="anchor" href="#paired-samples"></a>
</h2>
<p>Now let’s try a paired-samples design where the variables are from a
normal distribution. Each subject produces two scores (in conditions A
and B). What we need to know about these two scores is:</p>
<ul>
<li>How many subjects?</li>
<li>What are the score means?</li>
<li>What are the score variances (or SDs)?</li>
<li>What is the correlation between the scores?</li>
</ul>
<div class="section level3">
<h3 id="paired-params">Parameters<a class="anchor" aria-label="anchor" href="#paired-params"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sub_n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">A_mean</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">B_mean</span> <span class="op">&lt;-</span> <span class="fl">11</span></span>
<span><span class="va">A_sd</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">B_sd</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">AB_r</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="correlated-scores">Correlated Scores<a class="anchor" aria-label="anchor" href="#correlated-scores"></a>
</h3>
<p>You can then use <code><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi()</a></code> to generate a data table
with simulated values for correlated scores:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">faux</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="va">sub_n</span>, </span>
<span>    vars <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    r <span class="op">=</span> <span class="va">AB_r</span>, </span>
<span>    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_mean</span>, <span class="va">B_mean</span><span class="op">)</span>, </span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_sd</span>, <span class="va">B_sd</span><span class="op">)</span>, </span>
<span>    varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You can also do this using the <code><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">MASS::mvrnorm</a></code> function,
but <code><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">faux::rnorm_multi</a></code> is easier when you have more
variables to simulate.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make the correlation matrix</span></span>
<span><span class="va">cormat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">1</span>, <span class="va">AB_r</span>,</span>
<span>                   <span class="va">AB_r</span>,    <span class="fl">1</span><span class="op">)</span>, </span>
<span>             nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make a corresponding matrix of the variance </span></span>
<span><span class="co"># (multiply the SDs for each cell)</span></span>
<span><span class="va">varmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_sd</span> <span class="op">*</span> <span class="va">A_sd</span>, <span class="va">A_sd</span> <span class="op">*</span> <span class="va">B_sd</span>,</span>
<span>                   <span class="va">A_sd</span> <span class="op">*</span> <span class="va">B_sd</span>, <span class="va">B_sd</span> <span class="op">*</span> <span class="va">B_sd</span><span class="op">)</span>, </span>
<span>             nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># create correlated variables with the specified parameters</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">sub_n</span>, </span>
<span>                   mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_mean</span>, <span class="va">B_mean</span><span class="op">)</span>, </span>
<span>                   Sigma <span class="op">=</span> <span class="va">cormat</span> <span class="op">*</span> <span class="va">varmat</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  A <span class="op">=</span> <span class="va">S</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>  B <span class="op">=</span> <span class="va">S</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-your-data-1">Check your data<a class="anchor" aria-label="anchor" href="#check-your-data-1"></a>
</h3>
<p>Now check your data; <code>faux</code> has a function
<code><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params()</a></code> that gives you the correlation table, means,
and SDs for each numeric column in a data table.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">faux</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">##     n var    A    B  mean   sd</span></span>
<span><span class="co">## 1 100   A 1.00 0.49 10.09 2.57</span></span>
<span><span class="co">## 2 100   B 0.49 1.00 11.27 2.50</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-1">Analysis<a class="anchor" aria-label="anchor" href="#analysis-1"></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paired-samples t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">A</span>, <span class="va">dat</span><span class="op">$</span><span class="va">B</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Paired t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  dat$A and dat$B</span></span>
<span><span class="co">## t = -4.6022, df = 99, p-value = 1.242e-05</span></span>
<span><span class="co">## alternative hypothesis: true mean difference is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -1.6843022 -0.6694754</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean difference </span></span>
<span><span class="co">##       -1.176889</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="function-1">Function<a class="anchor" aria-label="anchor" href="#function-1"></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">paired_sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sub_n</span>, <span class="va">A_mean</span>, <span class="va">B_mean</span>, <span class="va">A_sd</span>, <span class="va">B_sd</span>, <span class="va">AB_r</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">faux</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="va">sub_n</span>, </span>
<span>    vars <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    r <span class="op">=</span> <span class="va">AB_r</span>, </span>
<span>    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_mean</span>, <span class="va">B_mean</span><span class="op">)</span>, </span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A_sd</span>, <span class="va">B_sd</span><span class="op">)</span>, </span>
<span>    varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">A</span>, <span class="va">dat</span><span class="op">$</span><span class="va">B</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># return just the values you care about</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    t <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">statistic</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    ci_lower <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    ci_upper <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    p <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">p.value</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    estimate <span class="op">=</span> <span class="va">t</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Run 1000 simulations and graph the results.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mysim_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">~</span><span class="fu">paired_sim</span><span class="op">(</span><span class="fl">100</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">2.5</span>, <span class="fl">2.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mysim_p</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">stat</span>, <span class="va">value</span>, <span class="va">t</span><span class="op">:</span><span class="va">estimate</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">value</span>, color <span class="op">=</span> <span class="va">stat</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">stat</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="fixed_files/figure-html/pair-sim-fig-1.png" alt="Distribution of results from simulated paired samples data" width="100%"><p class="caption">
Distribution of results from simulated paired samples data
</p>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mysim_p</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="va">power</span></span>
<span><span class="co">## [1] 0.983</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="intercept-model">Intercept model<a class="anchor" aria-label="anchor" href="#intercept-model"></a>
</h2>
<p>Now I’m going to show you a different way to simulate the same
design. This might seem excessively complicated, but you will need this
pattern when you start simulating data for mixed effects models.</p>
<div class="section level3">
<h3 id="parameters-1">Parameters<a class="anchor" aria-label="anchor" href="#parameters-1"></a>
</h3>
<p>Remember, we used the following parameters to set up our simulation
above:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub_n</span>  <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">A_mean</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">B_mean</span> <span class="op">&lt;-</span> <span class="fl">11</span></span>
<span><span class="va">A_sd</span>   <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">B_sd</span>   <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">AB_r</span>   <span class="op">&lt;-</span> <span class="fl">0.5</span></span></code></pre></div>
<p>From these, we can calculate the grand intercept (the overall mean
regardless of condition), and the effect of condition (the mean of B
minus A).</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grand_i</span>   <span class="op">&lt;-</span> <span class="op">(</span><span class="va">A_mean</span> <span class="op">+</span> <span class="va">B_mean</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="va">AB_effect</span> <span class="op">&lt;-</span> <span class="va">B_mean</span> <span class="op">-</span> <span class="va">A_mean</span></span></code></pre></div>
<p>We also need to think about variance a little differently. First,
calculate the pooled variance as the mean of the variances for A and B
(remember, variance is SD squared).</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pooled_var</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">A_sd</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">B_sd</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></code></pre></div>
<p>The variance of the subject intercepts is <code>r</code> times this
pooled variance and the error variance is what is left over. We take the
square root (<code><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt()</a></code>) to set the subject intercept and error
SDs for simulation later.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub_sd</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pooled_var</span> <span class="op">*</span> <span class="va">AB_r</span><span class="op">)</span></span>
<span><span class="va">error_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pooled_var</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">AB_r</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subject-intercepts">Subject intercepts<a class="anchor" aria-label="anchor" href="#subject-intercepts"></a>
</h3>
<p>Now we use these variables to create a data table for our subjects.
Each subject gets an ID and a <strong>random intercept</strong>
(<code>sub_i</code>). The intercept is simulated from a random normal
distribution with a mean of 0 and an SD of <code>sub_sd</code>. This
represents how much higher or lower than the average score each subject
tends to be (regardless of condition).</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  sub_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">sub_n</span>,</span>
<span>  sub_i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">sub_n</span>, <span class="fl">0</span>, <span class="va">sub_sd</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="observations">Observations<a class="anchor" aria-label="anchor" href="#observations"></a>
</h3>
<p>Next, set up a table where each row represents one observation. We’ll
use one of my favourite functions for simulation:
<code><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing()</a></code>. This creates every possible combination of the
listed factors (it works the same as <code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid()</a></code>, but the
results are in a more intuitive order). Here, we’re using it to create a
row for each subject in each condition, since this is a fully
within-subjects design.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">crossing</a></span><span class="op">(</span></span>
<span>  sub_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">sub_n</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculate-the-score">Calculate the score<a class="anchor" aria-label="anchor" href="#calculate-the-score"></a>
</h3>
<p>Next, we join the subject table so each row has the information about
the subject’s random intercept and then calculate the score. I’ve done
it in a few steps below for clarity. The score is just the sum of:</p>
<ul>
<li>the overall mean (<code>grand_i</code>)</li>
<li>the subject-specific intercept (<code>sub_i</code>)</li>
<li>the effect (<code>effect</code>): the numeric code for condition
(<code>condition.e</code>) multiplied by the effect of condition
(<code>AB_effect</code>)</li>
<li>the error term (simulated from a normal distribution with mean of 0
and SD of <code>error_sd</code>)</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">obs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sub</span>, by <span class="op">=</span> <span class="st">"sub_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    condition.e <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">condition</span>, <span class="st">"A"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    effect <span class="op">=</span> <span class="va">AB_effect</span> <span class="op">*</span> <span class="va">condition.e</span>,</span>
<span>    error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">error_sd</span><span class="op">)</span>,</span>
<span>    score <span class="op">=</span> <span class="va">grand_i</span> <span class="op">+</span> <span class="va">sub_i</span> <span class="op">+</span> <span class="va">effect</span> <span class="op">+</span> <span class="va">error</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Use <code>get_params</code> to check the data. With data in long
format, you need to specify the columns that contain the id, dv, and
within-id variables.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check the data</span></span>
<span><span class="fu">faux</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">dat</span>, </span>
<span>                 id <span class="op">=</span> <span class="st">"sub_id"</span>,</span>
<span>                 dv <span class="op">=</span> <span class="st">"score"</span>,</span>
<span>                 within <span class="op">=</span> <span class="st">"condition"</span><span class="op">)</span></span>
<span><span class="co">##     n var    A    B  mean   sd</span></span>
<span><span class="co">## 1 100   A 1.00 0.59  9.68 2.40</span></span>
<span><span class="co">## 2 100   B 0.59 1.00 10.33 2.58</span></span></code></pre></div>
<p>You can use the following code to put the data table into a more
familiar “wide” format.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_wide</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sub_id</span>, <span class="va">condition</span>, <span class="va">score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">condition</span>, <span class="va">score</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analyses">Analyses<a class="anchor" aria-label="anchor" href="#analyses"></a>
</h3>
<p>You can analyse the data with a paired-samples t-test from the wide
format:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paired-samples t-test from dat_wide</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">dat_wide</span><span class="op">$</span><span class="va">A</span>, <span class="va">dat_wide</span><span class="op">$</span><span class="va">B</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Paired t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  dat_wide$A and dat_wide$B</span></span>
<span><span class="co">## t = -2.8648, df = 99, p-value = 0.005095</span></span>
<span><span class="co">## alternative hypothesis: true mean difference is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -1.0923496 -0.1983759</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean difference </span></span>
<span><span class="co">##      -0.6453628</span></span></code></pre></div>
<p>Or in the long format:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paired-samples t-test from dat (long)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">condition</span>, <span class="va">dat</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Paired t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  score by condition</span></span>
<span><span class="co">## t = -2.8648, df = 99, p-value = 0.005095</span></span>
<span><span class="co">## alternative hypothesis: true mean difference is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -1.0923496 -0.1983759</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean difference </span></span>
<span><span class="co">##      -0.6453628</span></span></code></pre></div>
<p>You can analyse the data with ANOVA using the <code><a href="https://rdrr.io/pkg/afex/man/aov_car.html" class="external-link">aov_4()</a></code>
function from <code>afex</code>. (Notice how the F-value is the square
of the t-value above.)</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># anova using afex::aov_4</span></span>
<span><span class="va">aov</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html" class="external-link">aov_4</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="op">(</span><span class="va">condition</span> <span class="op">|</span> <span class="va">sub_id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">aov</span><span class="op">$</span><span class="va">anova_table</span></span>
<span><span class="co">## Anova Table (Type 3 tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: score</span></span>
<span><span class="co">##           num Df den Df    MSE      F      ges   Pr(&gt;F)   </span></span>
<span><span class="co">## condition      1     99 2.5373 8.2072 0.016676 0.005095 **</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>You can even analyse the data with a mixed effects model using the
<code>lmer</code> function (the <code>afex</code> version gives you
p-values, but the <code>lme4</code> version does not).</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mixed effect model using afex::lmer</span></span>
<span><span class="va">lmem</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">condition.e</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sub_id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># displays a tidy table of the fixed effects</span></span>
<span><span class="fu">broom.mixed</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">lmem</span>, effects <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">##   effect term        estimate std.error statistic    df  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> fixed  (Intercept)   10.0       0.222     45.0   99.0 9.08<span style="color: #949494;">e</span><span style="color: #BB0000;">-68</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> fixed  condition.e    0.645     0.225      2.86  99.0 5.10<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="simulate-a-dataset-from-an-analysis">Simulate a dataset from an analysis<a class="anchor" aria-label="anchor" href="#simulate-a-dataset-from-an-analysis"></a>
</h2>
<p>Simulate a dataset from the parameters of an analysis. We’ll use the
built-in dataset <code>mtcars</code> to predict miles per gallon
(<code>mpg</code>) from transmission type (<code>am</code>) and engine
type (<code>vs</code>).</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">am</span> <span class="op">*</span> <span class="va">vs</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   term        estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)    15.0       1.00     15.0  6.34<span style="color: #949494;">e</span><span style="color: #BB0000;">-15</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> am              4.70      1.74      2.71 1.14<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> vs              5.69      1.65      3.45 1.80<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> am:vs           2.93      2.54      1.15 2.59<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="simulate">Simulate<a class="anchor" aria-label="anchor" href="#simulate"></a>
</h3>
<p>We can now simulate a dataset with 50 observations from each
transmission type (<code>am</code>) and engine type (<code>vs</code>)
combination, then use the model parameters to generate predicted values
for <code>mpg</code>.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">err_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="co"># SD of the error term from the model</span></span>
<span><span class="va">fx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="co"># fixed effect coefficients</span></span>
<span></span>
<span><span class="va">sim_mtcars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  am <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>  vs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">0</span>, <span class="va">err_sd</span><span class="op">)</span>,</span>
<span>         mpg <span class="op">=</span> <span class="va">fx</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> </span>
<span>               <span class="va">fx</span><span class="op">[</span><span class="st">"am"</span><span class="op">]</span><span class="op">*</span><span class="va">am</span> <span class="op">+</span> </span>
<span>               <span class="va">fx</span><span class="op">[</span><span class="st">"vs"</span><span class="op">]</span><span class="op">*</span><span class="va">vs</span> <span class="op">+</span></span>
<span>               <span class="va">fx</span><span class="op">[</span><span class="st">"am:vs"</span><span class="op">]</span><span class="op">*</span><span class="va">am</span><span class="op">*</span><span class="va">vs</span> <span class="op">+</span> <span class="va">err</span><span class="op">)</span></span>
<span>  </span></code></pre></div>
<p>Analyse the simulated data with <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> and output the
results as a table using <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom::tidy()</a></code></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">am</span> <span class="op">*</span> <span class="va">vs</span>, data <span class="op">=</span> <span class="va">sim_mtcars</span><span class="op">)</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">sim_model</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   term        estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)    14.8      0.523     28.3  3.18<span style="color: #949494;">e</span><span style="color: #BB0000;">-71</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> am              5.61     0.739      7.60 1.21<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> vs              6.62     0.739      8.95 2.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> am:vs           1.96     1.05       1.87 6.24<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="function-2">Function<a class="anchor" aria-label="anchor" href="#function-2"></a>
</h3>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carsim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">b0</span>, <span class="va">b_am</span>, <span class="va">b_vs</span>, <span class="va">b_am_vs</span>, <span class="va">err_sd</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sim_mtcars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    am <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>    vs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="va">err_sd</span><span class="op">)</span>,</span>
<span>           mpg <span class="op">=</span> <span class="va">b0</span> <span class="op">+</span> <span class="va">b_am</span><span class="op">*</span><span class="va">am</span> <span class="op">+</span> <span class="va">b_vs</span><span class="op">*</span><span class="va">vs</span> <span class="op">+</span> <span class="va">b_am_vs</span><span class="op">*</span><span class="va">am</span><span class="op">*</span><span class="va">vs</span> <span class="op">+</span> <span class="va">err</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">sim_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">am</span> <span class="op">*</span> <span class="va">vs</span>, data <span class="op">=</span> <span class="va">sim_mtcars</span><span class="op">)</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">sim_model</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Run the function with the values from the original model, but cut the
fixed effect sizes in half.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">err_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">fx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span><span class="fu">carsim</span><span class="op">(</span><span class="fl">50</span>, <span class="va">fx2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">fx2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">fx2</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">fx2</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">err_sd</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   term        estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)    7.25      0.535    13.5   6.06<span style="color: #949494;">e</span><span style="color: #BB0000;">-30</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> am             2.78      0.757     3.67  3.11<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> vs             3.97      0.757     5.25  3.95<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> am:vs         -<span style="color: #BB0000;">0.200</span>     1.07     -<span style="color: #BB0000;">0.187</span> 8.52<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span></code></pre></div>
<p>Repeat this 100 time and calculate power for each effect.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simstats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">~</span><span class="fu">carsim</span><span class="op">(</span><span class="fl">50</span>, <span class="va">fx2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">fx2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">fx2</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">fx2</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">err_sd</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simstats</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">.05</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">##   term        power</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)  1   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> am           0.92</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> am:vs        0.3 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> vs           0.96</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<p>Using the dataset below, predict <code>moral</code> disgust from the
interaction between <code>pathogen</code> and <code>sexual</code>
disgust using <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">disgust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"https://psyteachr.github.io/msc-data-skills/data/disgust_scores.csv"</span><span class="op">)</span></span>
<span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">20000</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">6</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span>  (5): id, user_id, moral, pathogen, sexual</span></span>
<span><span class="co">## <span style="color: #0000BB;">date</span> (1): date</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<p>Simulate a new dataset of 100 people with a similar pathogen and
sexual disgust distribution to the original dataset. Remember that these
are likely to be correlated and that scores can only range from 0 to 6.
(Hint: look at the help for <code>norm2trunc</code>)</p>
<p>Write a function to simulate data, analyse it, and return a table of
results. Make sure you can vary the important parameters using
arguments.</p>
<p>Calculate power for the same fixed effects as in the original
analysis. Adjust the N until the dsign has around .80 power to detect a
main effect of pathogen disgust.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lisa DeBruine.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
