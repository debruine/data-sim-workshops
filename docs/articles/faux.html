<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intro to Faux • dsw</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Intro to Faux">
<meta property="og:description" content="dsw">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dsw</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calories.html">Calorie Placement Re-Simulation</a>
    </li>
    <li>
      <a href="../articles/faux.html">Intro to Faux</a>
    </li>
    <li>
      <a href="../articles/fixed.html">Fixed Effects</a>
    </li>
    <li>
      <a href="../articles/mixed.html">Mixed Effects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/debruine/data-sim-workshop/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Intro to Faux</h1>
                        <h4 data-toc-skip class="author">Lisa
DeBruine</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/debruine/data-sim-workshop/blob/HEAD/vignettes/faux.Rmd" class="external-link"><code>vignettes/faux.Rmd</code></a></small>
      <div class="hidden name"><code>faux.Rmd</code></div>

    </div>

    
    
<p>In this tutorial, we’ll learn how to simulate data for factorial
designs using {faux}. There are more extensive examples at <a href="https://debruine.github.io/faux/" class="external-link uri">https://debruine.github.io/faux/</a>.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>We’ll be using 4 packages in this tutorial.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span> <span class="co"># for data wrangling</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/debruine/faux" class="external-link">faux</a></span><span class="op">)</span>      <span class="co"># for simulation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span>     <span class="co"># for tidy analysis results</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://afex.singmann.science/" class="external-link">afex</a></span><span class="op">)</span>      <span class="co"># for ANOVA</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8675309</span><span class="op">)</span> <span class="co"># Jenny, I've got your number</span></code></pre></div>
<p>A seed makes randomness reproducible. Run the following code several
times. Change the seed to your favourite integer. If the seed is the
same, the random numbers after it will be the same, as long as the code
is always executed in the same order.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="co">## [1] 1.262954</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="normal">Normal<a class="anchor" aria-label="anchor" href="#normal"></a>
</h2>
<p>Let’s start with a normal distribution using the base R function
<code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm()</a></code>, which returns <code>n</code> values from a normal
distribution with a mean of 0 and a standard deviation of 1.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">##  [1] -0.326233361  1.329799263  1.272429321  0.414641434 -1.539950042</span>
<span class="co">##  [6] -0.928567035 -0.294720447 -0.005767173  2.404653389  0.763593461</span></code></pre></div>
<p>You can change the mean and SD. Simulate a lot of values (1e5 ==
100,000) and visualise them with <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1e5</span>, mean <span class="op">=</span> <span class="fl">30</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="multivariate-normal">Multivariate normal<a class="anchor" aria-label="anchor" href="#multivariate-normal"></a>
</h2>
<p>But how do you create correlated values? You can do this with
<code><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">MASS::mvrnorm()</a></code>, but you need to construct the
<code>Sigma</code> argument yourself from the correlation matrix and the
standard deviations of the populations, and then you need to turn the
resulting matrix into a data frame for many use cases. This isn’t very
difficult, but can be tedious with larger numbers of variables.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fl">1e5</span> <span class="co"># this is a large number to demonstrate that the result is as expected</span>
<span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">1</span>, B <span class="op">=</span> <span class="fl">2</span>, C <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">sd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>
<span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.25</span>, <span class="fl">.5</span><span class="op">)</span>

<span class="va">cor_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">r</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">r</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, 
                    <span class="va">r</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">r</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
                    <span class="va">r</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">r</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, 
                  nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sd</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">cor_mat</span>
<span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu</span>, <span class="va">Sigma</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>
<span class="co">##      A   B    C</span>
<span class="co">## A 1.00 0.0 0.24</span>
<span class="co">## B 0.00 1.0 0.50</span>
<span class="co">## C 0.24 0.5 1.00</span></code></pre></div>
<div class="section level3">
<h3 id="rnorm_multi">rnorm_multi<a class="anchor" aria-label="anchor" href="#rnorm_multi"></a>
</h3>
<p>In faux, you can create sets of correlated normally distributed
values using <code><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">50</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">1</span>, B <span class="op">=</span> <span class="fl">2</span>, C <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,
  r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.25</span>, <span class="fl">.5</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>The function <code><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params()</a></code> gives you a quick way to see
the means, SDs and correlations in the simulated data set to make sure
you set the parameters correctly.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">)</span>
<span class="co">##    n var    A    B    C mean   sd</span>
<span class="co">## 1 50   A 1.00 0.10 0.24 1.10 0.49</span>
<span class="co">## 2 50   B 0.10 1.00 0.34 2.00 0.86</span>
<span class="co">## 3 50   C 0.24 0.34 1.00 3.06 1.32</span></code></pre></div>
<p>If you set <code>empirical</code> to <code>TRUE</code>, the values
you set will be the <strong>sample</strong> parameters, not the
<strong>population</strong> parameters. This isn’t usually what you want
for a simulation, but can be useful to check you set the parameters
correctly.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">50</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">1</span>, B <span class="op">=</span> <span class="fl">2</span>, C <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,
  r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.25</span>, <span class="fl">.5</span><span class="op">)</span>,
  empirical <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">)</span>
<span class="co">##    n var    A   B    C mean  sd</span>
<span class="co">## 1 50   A 1.00 0.0 0.25    1 0.5</span>
<span class="co">## 2 50   B 0.00 1.0 0.50    2 1.0</span>
<span class="co">## 3 50   C 0.25 0.5 1.00    3 1.5</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shortcuts">Shortcuts<a class="anchor" aria-label="anchor" href="#shortcuts"></a>
</h3>
<p>There are a few shortcuts you can use. Run the following and see if
you can guess how they work.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">guess1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, 
                      mu <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, 
                      varnames <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, 
                      empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">guess1</span><span class="op">)</span>
<span class="co">##    n var A B C mean sd</span>
<span class="co">## 1 50   A 1 0 0    1  1</span>
<span class="co">## 2 50   B 0 1 0    2  1</span>
<span class="co">## 3 50   C 0 0 1    3  1</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">guess2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, vars <span class="op">=</span> <span class="fl">4</span>, r <span class="op">=</span> <span class="fl">0.5</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">guess2</span><span class="op">)</span>
<span class="co">##    n var  X1  X2  X3  X4 mean sd</span>
<span class="co">## 1 50  X1 1.0 0.5 0.5 0.5    0  1</span>
<span class="co">## 2 50  X2 0.5 1.0 0.5 0.5    0  1</span>
<span class="co">## 3 50  X3 0.5 0.5 1.0 0.5    0  1</span>
<span class="co">## 4 50  X4 0.5 0.5 0.5 1.0    0  1</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get correlation matrix, means and SDs for 4 variables from iris</span>
<span class="va">iris_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="va">iris_mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="va">iris_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># colSDs</span>

<span class="va">guess3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, 
                      mu <span class="op">=</span> <span class="va">iris_mu</span>, 
                      sd <span class="op">=</span> <span class="va">iris_sd</span>, 
                      r <span class="op">=</span> <span class="va">iris_r</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">guess3</span><span class="op">)</span>
<span class="co">##    n          var Sepal.Length Sepal.Width Petal.Length Petal.Width mean   sd</span>
<span class="co">## 1 50 Sepal.Length         1.00       -0.13         0.88        0.79 6.01 0.82</span>
<span class="co">## 2 50  Sepal.Width        -0.13        1.00        -0.39       -0.30 3.09 0.37</span>
<span class="co">## 3 50 Petal.Length         0.88       -0.39         1.00        0.95 3.83 1.66</span>
<span class="co">## 4 50  Petal.Width         0.79       -0.30         0.95        1.00 1.22 0.68</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="setting-r">Setting r<a class="anchor" aria-label="anchor" href="#setting-r"></a>
</h3>
<p>You can set the <code>r</code> argument for correlations in a few
different ways.</p>
<p>If all correlations have the same value, just set r equal to a single
number.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># all correlations the same value</span>
<span class="va">rho_same</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">4</span>, r <span class="op">=</span> <span class="fl">.5</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">rho_same</span><span class="op">)</span>
<span class="co">##    n var  X1  X2  X3  X4 mean sd</span>
<span class="co">## 1 50  X1 1.0 0.5 0.5 0.5    0  1</span>
<span class="co">## 2 50  X2 0.5 1.0 0.5 0.5    0  1</span>
<span class="co">## 3 50  X3 0.5 0.5 1.0 0.5    0  1</span>
<span class="co">## 4 50  X4 0.5 0.5 0.5 1.0    0  1</span></code></pre></div>
<p>You can set rho to a vector or matrix of the full correlation matrix.
This is convenient when you’re getting the values from an existing
dataset, where you can just use the output of the <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor()</a></code>
function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># full correlation matrix</span>
<span class="co">#         X1   X2   X3   X4</span>
<span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="co"># X1</span>
         <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="co"># X2</span>
         <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="co"># X3</span>
         <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span><span class="op">)</span> <span class="co"># X4</span>
<span class="va">rho_cormat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">4</span>, r <span class="op">=</span> <span class="va">rho</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">rho_cormat</span><span class="op">)</span>
<span class="co">##    n var  X1  X2  X3  X4 mean sd</span>
<span class="co">## 1 50  X1 1.0 0.5 0.4 0.3    0  1</span>
<span class="co">## 2 50  X2 0.5 1.0 0.2 0.1    0  1</span>
<span class="co">## 3 50  X3 0.4 0.2 1.0 0.0    0  1</span>
<span class="co">## 4 50  X4 0.3 0.1 0.0 1.0    0  1</span></code></pre></div>
<p>Alternatively, you can just specify the values from the upper right
triangle of a correlation matrix. This is easier if you’re reading the
values out of a paper.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># upper right triangle</span>
<span class="co">#         X2   X3   X4</span>
<span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="co"># X1</span>
              <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="co"># X2</span>
                   <span class="fl">0.0</span><span class="op">)</span> <span class="co"># X3</span>

<span class="va">rho_urt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">4</span>, r <span class="op">=</span> <span class="va">rho</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">rho_urt</span><span class="op">)</span>
<span class="co">##    n var  X1  X2  X3  X4 mean sd</span>
<span class="co">## 1 50  X1 1.0 0.5 0.4 0.3    0  1</span>
<span class="co">## 2 50  X2 0.5 1.0 0.2 0.1    0  1</span>
<span class="co">## 3 50  X3 0.4 0.2 1.0 0.0    0  1</span>
<span class="co">## 4 50  X4 0.3 0.1 0.0 1.0    0  1</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="factorial-designs">Factorial Designs<a class="anchor" aria-label="anchor" href="#factorial-designs"></a>
</h2>
<p>You can use <code><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html" class="external-link">rnorm_multi()</a></code> to simulate data for each
between-subjects cell of a factorial design and manually combine the
tables, but faux has a function that better maps onto how we usually
think and teach about factorial designs.</p>
<p>The default design is 100 observations of one variable (named
<code>y</code>) with a mean of 0 and SD of 1. Unless you set
<code>plot = FALSE</code> or run
<code>faux_options(plot = FALSE)</code>, this function will show you a
plot of your design so you can check that it looks like you expect.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simdat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-15-1.png" width="100%"></p>
<div class="section level3">
<h3 id="factors">Factors<a class="anchor" aria-label="anchor" href="#factors"></a>
</h3>
<p>Use lists to set the names and levels of <code>within</code> and
<code>between</code> subject factors.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-16-1.png" width="100%"></p>
<p>You can set <code>mu</code> and <code>sd</code> with unnamed vectors,
but getting the order right can take some trial and error.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  mu <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-17-1.png" width="100%"></p>
<p>You can set values with a named vector for a single type of factor.
The values do not have to be in the right order if they’re named.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="fl">1</span>, ferret <span class="op">=</span> <span class="fl">5</span>, dog <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>pre <span class="op">=</span> <span class="fl">1</span>, post <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-18-1.png" width="100%"></p>
<p>Or use a data frame for within- and between-subject factors.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
    pre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,
    post <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,
    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-19-1.png" width="100%"></p>
<p>If you have within-subject factors, set the correlations for each
between-subject cell like this.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="fl">0.5</span>,
           dog <span class="op">=</span> <span class="fl">0.25</span>,
           ferret <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  empirical <span class="op">=</span> <span class="cn">TRUE</span>,
  plot <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">pettime</span><span class="op">)</span>
<span class="co">##      pet   n  var  pre post mean sd</span>
<span class="co">## 1    cat 100  pre 1.00 0.50    0  1</span>
<span class="co">## 2    cat 100 post 0.50 1.00    0  1</span>
<span class="co">## 3    dog 100  pre 1.00 0.25    0  1</span>
<span class="co">## 4    dog 100 post 0.25 1.00    0  1</span>
<span class="co">## 5 ferret 100  pre 1.00 0.00    0  1</span>
<span class="co">## 6 ferret 100 post 0.00 1.00    0  1</span></code></pre></div>
<p>You can also change the name of the <code>dv</code> and
<code>id</code> columns and output the data in long format. If you do
this, you also need to tell <code><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params()</a></code> what columns
contain the between- and within-subject factors, the dv, and the id.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  id <span class="op">=</span> <span class="st">"subj_id"</span>,
  dv <span class="op">=</span> <span class="st">"score"</span>,
  long <span class="op">=</span> <span class="cn">TRUE</span>,
  plot <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html" class="external-link">get_params</a></span><span class="op">(</span><span class="va">dat_long</span>, 
           between <span class="op">=</span> <span class="st">"pet"</span>, 
           within <span class="op">=</span> <span class="st">"time"</span>,
           id <span class="op">=</span> <span class="st">"subj_id"</span>,
           dv <span class="op">=</span> <span class="st">"score"</span>,
           digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">##      pet   n  var    pre   post  mean    sd</span>
<span class="co">## 1    cat 100  pre  1.000 -0.070 0.013 1.031</span>
<span class="co">## 2    cat 100 post -0.070  1.000 0.009 0.918</span>
<span class="co">## 3    dog 100  pre  1.000  0.133 0.095 0.994</span>
<span class="co">## 4    dog 100 post  0.133  1.000 0.096 1.028</span>
<span class="co">## 5 ferret 100  pre  1.000 -0.001 0.060 1.030</span>
<span class="co">## 6 ferret 100 post -0.001  1.000 0.018 1.054</span></code></pre></div>
<p><em>The current version of faux doesn’t actually need
<code>between</code> or <code>dv</code> and later versions won’t need
<code>within</code> or <code>id</code> if a data frame was created with
faux.</em></p>
</div>
<div class="section level3">
<h3 id="anonymous-factors">Anonymous Factors<a class="anchor" aria-label="anchor" href="#anonymous-factors"></a>
</h3>
<p>If you need to make a quick demo, you can set factors anonymously
with integer vectors. For example, the following code makes 3B*2B*2W
mixed design.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_anon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">50</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,
  within <span class="op">=</span> <span class="fl">2</span>,
  mu <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-22-1.png" width="100%"></p>
<p>Faux has a quick plotting function for visualising data made with
faux. The plot created by <code><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design()</a></code> shows the
<em>design</em>, while this function shows the simulated
<em>data</em>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dat_anon</span><span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-23-1.png" width="100%"></p>
<p>You can change the order of plotting and the types of geoms plotted.
This takes a little trial and error, so this function will probably be
refined in later versions.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dat_anon</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"W1"</span>, geoms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"violin"</span>, <span class="st">"pointrangeSD"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-24-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="replications">Replications<a class="anchor" aria-label="anchor" href="#replications"></a>
</h2>
<p>You often want to simulate data repeatedly to do things like
calculate power. The <code><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design()</a></code> function has a lot of
overhead for checking if a design makes sense and if the correlation
matrix is possible, so you can speed up the creation of multiple
datasets with the same design using the <code>rep</code> argument. This
will give you a nested data frame with each dataset in the
<code>data</code> column.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fl">2</span>,
  n <span class="op">=</span> <span class="fl">20</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>,
  rep <span class="op">=</span> <span class="fl">5</span>,
  plot <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="analyse-each-replicate">Analyse each replicate<a class="anchor" aria-label="anchor" href="#analyse-each-replicate"></a>
</h3>
<p>You can run analyses on the nested data by wrapping your analysis
code in a function then using <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map()</a></code> to run the analysis on
each data set and <code><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest()</a></code> to expand the results into a
data table.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define function</span>
<span class="va">analyse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">W1a</span>, <span class="va">data</span><span class="op">$</span><span class="va">W1b</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/faux/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># get one test data set</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">dat_rep</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="co"># check function returns what you want</span>
<span class="fu">analyse</span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">## <span style="color: #949494;"># A tibble: 1 × 8</span></span>
<span class="co">##   estimate statistic p.value parameter conf.low conf.high method     alternative</span>
<span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span>
<span class="co">## <span style="color: #BCBCBC;">1</span>   0.092<span style="text-decoration: underline;">6</span>     0.305   0.763        19   -<span style="color: #BB0000;">0.542</span>     0.727 Paired t-… two.sided</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run the function on each data set</span>
<span class="va">dat_rep</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>analysis <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">analyse</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">data</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span>
<span class="co">## <span style="color: #949494;"># A tibble: 5 × 9</span></span>
<span class="co">##     rep estimate statistic p.value parameter conf.low conf.high method       </span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span>
<span class="co">## <span style="color: #BCBCBC;">1</span>     1   0.092<span style="text-decoration: underline;">6</span>     0.305  0.763         19   -<span style="color: #BB0000;">0.542</span>    0.727  Paired t-test</span>
<span class="co">## <span style="color: #BCBCBC;">2</span>     2   0.269      0.717  0.482         19   -<span style="color: #BB0000;">0.517</span>    1.05   Paired t-test</span>
<span class="co">## <span style="color: #BCBCBC;">3</span>     3  -<span style="color: #BB0000;">0.338</span>     -<span style="color: #BB0000;">1.06</span>   0.303         19   -<span style="color: #BB0000;">1.01</span>     0.330  Paired t-test</span>
<span class="co">## <span style="color: #BCBCBC;">4</span>     4  -<span style="color: #BB0000;">0.473</span>     -<span style="color: #BB0000;">1.83</span>   0.082<span style="text-decoration: underline;">3</span>        19   -<span style="color: #BB0000;">1.01</span>     0.066<span style="text-decoration: underline;">8</span> Paired t-test</span>
<span class="co">## <span style="color: #BCBCBC;">5</span>     5  -<span style="color: #BB0000;">0.519</span>     -<span style="color: #BB0000;">1.49</span>   0.153         19   -<span style="color: #BB0000;">1.25</span>     0.210  Paired t-test</span>
<span class="co">## <span style="color: #949494;"># … with 1 more variable: alternative &lt;chr&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="anova">ANOVA<a class="anchor" aria-label="anchor" href="#anova"></a>
</h3>
<p>Use the same pattern to run an ANOVA on a version of the
<code>pettime</code> dataset.</p>
<p>First, simulate 100 datasets in long format. These data will have
small main effects of pet and time, but no interaction.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span><span class="op">)</span><span class="op">)</span>,
  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="fl">50</span>, dog <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
    pre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.2</span><span class="op">)</span>,
    post <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.4</span><span class="op">)</span>,
    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span><span class="op">)</span>
  <span class="op">)</span>,
  sd <span class="op">=</span> <span class="fl">1</span>,
  id <span class="op">=</span> <span class="st">"pet_id"</span>,
  dv <span class="op">=</span> <span class="st">"score"</span>,
  r <span class="op">=</span> <span class="fl">0.5</span>,
  long <span class="op">=</span> <span class="cn">TRUE</span>,
  rep <span class="op">=</span> <span class="fl">100</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-28-1.png" width="100%"></p>
<p>Then set up your analysis. We’ll use the <code><a href="https://rdrr.io/pkg/afex/man/aov_car.html" class="external-link">aov_ez()</a></code>
function from the {afex} package because its arguments match those of
<code><a href="https://rdrr.io/pkg/faux/man/sim_design.html" class="external-link">sim_design()</a></code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/set_sum_contrasts.html" class="external-link">set_sum_contrasts</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># avoids annoying afex message</span>
<span class="co">## setting contr.sum globally: options(contrasts=c('contr.sum', 'contr.poly'))</span>
<span class="fu"><a href="https://rdrr.io/pkg/afex/man/afex_options.html" class="external-link">afex_options</a></span><span class="op">(</span>include_aov <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># runs faster</span>
<span class="fu"><a href="https://rdrr.io/pkg/afex/man/afex_options.html" class="external-link">afex_options</a></span><span class="op">(</span>es_aov <span class="op">=</span> <span class="st">"pes"</span><span class="op">)</span> <span class="co"># changes effect size measure to partial eta squared</span>

<span class="va">analyse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html" class="external-link">aov_ez</a></span><span class="op">(</span>
    id <span class="op">=</span> <span class="st">"pet_id"</span>,
    dv <span class="op">=</span> <span class="st">"score"</span>,
    between <span class="op">=</span> <span class="st">"pet"</span>,
    within <span class="op">=</span> <span class="st">"time"</span>,
    data <span class="op">=</span> <span class="va">data</span>
  <span class="op">)</span> 
  <span class="co"># return anova_table for GG-corrected DF</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">anova_table</span>, rownames <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> |&gt;
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">term</span>, levels <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="co"># keeps terms in order</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>p.value <span class="op">=</span> <span class="va">`Pr(&gt;F)`</span><span class="op">)</span> <span class="co"># fixes annoying p.value name</span>
<span class="op">}</span></code></pre></div>
<p>Test the analysis code.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">pettime100</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="fu">analyse</span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">## <span style="color: #949494;"># A tibble: 3 × 7</span></span>
<span class="co">##   term     `num Df` `den Df`   MSE     F     pes p.value</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> pet             1       88 1.87  0.859 0.009<span style="text-decoration: underline;">67</span>   0.357</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> time            1       88 0.507 1.66  0.018<span style="text-decoration: underline;">5</span>    0.201</span>
<span class="co">## <span style="color: #BCBCBC;">3</span> pet:time        1       88 0.507 0.104 0.001<span style="text-decoration: underline;">19</span>   0.747</span></code></pre></div>
<p>Make a table of the results of each analysis:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime_sim</span> <span class="op">&lt;-</span> <span class="va">pettime100</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>analysis <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">analyse</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">data</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 × 8</span></span>
<span class="co">##     rep term     `num Df` `den Df`   MSE     F   pes p.value</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span>     1 pet             1       88 1.87  0.859 0.01    0.357</span>
<span class="co">## <span style="color: #BCBCBC;">2</span>     1 time            1       88 0.507 1.66  0.019   0.201</span>
<span class="co">## <span style="color: #BCBCBC;">3</span>     1 pet:time        1       88 0.507 0.104 0.001   0.747</span>
<span class="co">## <span style="color: #BCBCBC;">4</span>     2 pet             1       88 1.53  0.895 0.01    0.347</span>
<span class="co">## <span style="color: #BCBCBC;">5</span>     2 time            1       88 0.455 0.567 0.006   0.453</span>
<span class="co">## <span style="color: #BCBCBC;">6</span>     2 pet:time        1       88 0.455 2.91  0.032   0.091</span></code></pre>
<p>Then you can summarise the data to calculate things like power for
each effect or mean effect size.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime_sim</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>,
            mean_pes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pes</span><span class="op">)</span>,
            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span>
<span class="co">## <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="co">##   term     power mean_pes</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> pet       0.21   0.023<span style="text-decoration: underline;">6</span></span>
<span class="co">## <span style="color: #BCBCBC;">2</span> time      0.51   0.053<span style="text-decoration: underline;">0</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> pet:time  0.02   0.010<span style="text-decoration: underline;">5</span></span></code></pre></div>
<p>The power for the between-subjects effect of pet is smaller than for
the within-subjects effect of time. What happens if you reduce the
correlation between pre and post?</p>
</div>
</div>
<div class="section level2">
<h2 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<div class="section level3">
<h3 id="multivariate-normal-1">Multivariate normal<a class="anchor" aria-label="anchor" href="#multivariate-normal-1"></a>
</h3>
<p>Sample 40 values of three variables named <code>J</code>,
<code>K</code> and <code>L</code> from a population with means of 10, 20
and 30, and SDs of 5. <code>J</code> and <code>K</code> are correlated
0.5, <code>J</code> and <code>L</code> are correlated 0.25, and
<code>K</code> and <code>L</code> are not correlated.</p>
</div>
<div class="section level3">
<h3 id="from-existing-data">From existing data<a class="anchor" aria-label="anchor" href="#from-existing-data"></a>
</h3>
<p>Using the data from the built-in dataset <code>attitude</code>,
simulate a new set of 20 observations drawn from a population with the
same means, SDs and correlations for each column as the original
data.</p>
</div>
<div class="section level3">
<h3 id="b">2b<a class="anchor" aria-label="anchor" href="#b"></a>
</h3>
<p>Create a dataset with a between-subject factor of “pet” having two
levels, “cat”, and “dog”. The DV is “happiness” score. There are 20
cat-owners with a mean happiness score of 10 (SD = 3) and there are 30
dog-owners with a mean happiness score of 11 (SD = 3).</p>
</div>
<div class="section level3">
<h3 id="w">3w<a class="anchor" aria-label="anchor" href="#w"></a>
</h3>
<p>Create a dataset of 20 observations with 1 within-subject variable
(“condition”) having 3 levels (“A”, “B”, “C”) with means of 10, 20 and
30 and SD of 5. The correlations between each level have r = 0.4. The
dataset should look like this:</p>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">condition</th>
<th align="right">score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">S01</td>
<td align="left">A</td>
<td align="right">9.17</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
<tr class="odd">
<td align="left">S20</td>
<td align="left">A</td>
<td align="right">11.57</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">B</td>
<td align="right">18.44</td>
</tr>
<tr class="odd">
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
<tr class="even">
<td align="left">S20</td>
<td align="left">B</td>
<td align="right">20.04</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">C</td>
<td align="right">35.11</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
<tr class="odd">
<td align="left">S20</td>
<td align="left">C</td>
<td align="right">29.16</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="w2w">2w*2w<a class="anchor" aria-label="anchor" href="#w2w"></a>
</h3>
<p>Create a dataset with 50 observations of 2 within-subject variables
(“W1” and “W2”) each having 2 levels. The mean for all cells is 10 and
the SD is 2. The dataset should have 20 subjects. The correlations look
like this:</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">W1a_W2a</th>
<th align="right">W1a_W2b</th>
<th align="right">W1b_W2a</th>
<th align="right">W1b_W2b</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">W1a_W2a</td>
<td align="right">1.0</td>
<td align="right">0.5</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="left">W1a_W2b</td>
<td align="right">0.5</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.5</td>
</tr>
<tr class="odd">
<td align="left">W1b_W2a</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">W1b_W2b</td>
<td align="right">0.2</td>
<td align="right">0.5</td>
<td align="right">0.5</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="w3b">2w*3b<a class="anchor" aria-label="anchor" href="#w3b"></a>
</h3>
<p>Create a dataset with a between-subject factor of “pet” having 3
levels (“cat”, “dog”, and “ferret”) and a within-subject factor of
“time” having 2 levels (“pre” and “post”). The N in each group should be
10. Means are:</p>
<ul>
<li>cats: pre = 10, post = 12</li>
<li>dogs: pre = 14, post = 16</li>
<li>ferrets: pre = 18, post = 20</li>
</ul>
<p>SDs are all 5 and within-cell correlations are all 0.25.</p>
</div>
<div class="section level3">
<h3 id="replications-1">Replications<a class="anchor" aria-label="anchor" href="#replications-1"></a>
</h3>
<p>Create 5 datasets with a 2b*2b design, 30 participants in each cell.
Each cell’s mean should be 0, except B1a:B2a, which should be 0.5. The
SD should be 1. Make the resulting data in long format.</p>
</div>
<div class="section level3">
<h3 id="power">Power<a class="anchor" aria-label="anchor" href="#power"></a>
</h3>
<p>Simulate 100 datasets like the one above and use <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> or
<code><a href="https://rdrr.io/pkg/afex/man/aov_car.html" class="external-link">afex::aov_ez()</a></code> to look at the interaction between A and B.
What is the power of this design?</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Lisa DeBruine.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
