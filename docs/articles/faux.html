<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intro to Faux • dsw</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Intro to Faux">
<meta property="og:description" content="dsw">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dsw</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calories.html">Calorie Placement Re-Simulation</a>
    </li>
    <li>
      <a href="../articles/faux.html">Intro to Faux</a>
    </li>
    <li>
      <a href="../articles/fixed.html">Fixed Effects</a>
    </li>
    <li>
      <a href="../articles/mixed.html">Mixed Effects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/debruine/data-sim-workshop/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="faux_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Intro to Faux</h1>
                        <h4 class="author">Lisa DeBruine</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/debruine/data-sim-workshop/blob/master/vignettes/faux.Rmd"><code>vignettes/faux.Rmd</code></a></small>
      <div class="hidden name"><code>faux.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/debruine/faux">faux</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://afex.singmann.science/">afex</a></span><span class="op">)</span></code></pre></div>
<p>In this tutorial, we’ll learn how to simulate data for factorial designs using {faux}. There are more extensive examples at <a href="https://debruine.github.io/faux/" class="uri">https://debruine.github.io/faux/</a>.</p>
<div id="multivariate-normal" class="section level2">
<h2 class="hasAnchor">
<a href="#multivariate-normal" class="anchor"></a>Multivariate normal</h2>
<p>You can create sets of correlated normally distributed values using <code><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">50</span>,
  vars <span class="op">=</span> <span class="fl">3</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,
  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,
  r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.25</span>, <span class="fl">.5</span><span class="op">)</span>,
  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>The function <code><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params()</a></code> gives you a quick way to see the means, SDs and correlations in the simulated data set to make sure you set the parameters correctly.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">)</span>
<span class="co">##    n var    A    B    C mean   sd</span>
<span class="co">## 1 50   A 1.00 0.01 0.31 1.00 0.42</span>
<span class="co">## 2 50   B 0.01 1.00 0.38 1.93 0.92</span>
<span class="co">## 3 50   C 0.31 0.38 1.00 2.85 1.31</span></code></pre></div>
<p>If you set <code>empirical</code> to <code>TRUE</code>, the values you set will be the <strong>sample</strong> parameters, not the <strong>population</strong> parameters. This isn’t usually what you want for a simulation, but can be useful to check you set the parameters correctly.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">50</span>,
  vars <span class="op">=</span> <span class="fl">3</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,
  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,
  r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.25</span>, <span class="fl">.5</span><span class="op">)</span>,
  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,
  empirical <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">)</span>
<span class="co">##    n var    A   B    C mean  sd</span>
<span class="co">## 1 50   A 1.00 0.0 0.25    1 0.5</span>
<span class="co">## 2 50   B 0.00 1.0 0.50    2 1.0</span>
<span class="co">## 3 50   C 0.25 0.5 1.00    3 1.5</span></code></pre></div>
<div id="shortcuts" class="section level3">
<h3 class="hasAnchor">
<a href="#shortcuts" class="anchor"></a>Shortcuts</h3>
<p>There are a few shortcuts you can use. Run the following and see if you can guess how they work.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">guess1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">2</span>, z <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">guess1</span><span class="op">)</span>
<span class="co">##    n var x y z mean sd</span>
<span class="co">## 1 50   x 1 0 0    1  1</span>
<span class="co">## 2 50   y 0 1 0    2  1</span>
<span class="co">## 3 50   z 0 0 1    3  1</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">guess2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, vars <span class="op">=</span> <span class="fl">4</span>, r <span class="op">=</span> <span class="fl">0.5</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">guess2</span><span class="op">)</span>
<span class="co">##    n var  X1  X2  X3  X4 mean sd</span>
<span class="co">## 1 50  X1 1.0 0.5 0.5 0.5    0  1</span>
<span class="co">## 2 50  X2 0.5 1.0 0.5 0.5    0  1</span>
<span class="co">## 3 50  X3 0.5 0.5 1.0 0.5    0  1</span>
<span class="co">## 4 50  X4 0.5 0.5 0.5 1.0    0  1</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iris_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="va">iris_mu</span> <span class="op">&lt;-</span> <span class="fu">summarise_all</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">iris_sd</span> <span class="op">&lt;-</span> <span class="fu">summarise_all</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">sd</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">guess3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, 
                      mu <span class="op">=</span> <span class="va">iris_mu</span>, 
                      sd <span class="op">=</span> <span class="va">iris_sd</span>, 
                      r <span class="op">=</span> <span class="va">iris_r</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">guess3</span><span class="op">)</span>
<span class="co">##    n          var Sepal.Length Sepal.Width Petal.Length Petal.Width mean   sd</span>
<span class="co">## 1 50 Sepal.Length         1.00       -0.19         0.84        0.81 6.03 0.77</span>
<span class="co">## 2 50  Sepal.Width        -0.19        1.00        -0.57       -0.49 3.10 0.50</span>
<span class="co">## 3 50 Petal.Length         0.84       -0.57         1.00        0.97 3.90 1.79</span>
<span class="co">## 4 50  Petal.Width         0.81       -0.49         0.97        1.00 1.25 0.76</span></code></pre></div>
<p>You can set the r for correlations in a few different ways.</p>
<p>If all correlations have the same value, just set r equal to a single number.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># all correlations the same value</span>
<span class="va">rho_same</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">4</span>, r <span class="op">=</span> <span class="fl">.5</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">rho_same</span><span class="op">)</span>
<span class="co">##    n var  X1  X2  X3  X4 mean sd</span>
<span class="co">## 1 50  X1 1.0 0.5 0.5 0.5    0  1</span>
<span class="co">## 2 50  X2 0.5 1.0 0.5 0.5    0  1</span>
<span class="co">## 3 50  X3 0.5 0.5 1.0 0.5    0  1</span>
<span class="co">## 4 50  X4 0.5 0.5 0.5 1.0    0  1</span></code></pre></div>
<p>You can set rho to a vector or matrix of the full correlation matrix. This is convenient when you’re getting the values from an existing dataset, where you can just use the output of the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># full correlation matrix</span>
<span class="co">#         X1   X2   X3   X4</span>
<span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="co"># X1</span>
         <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="co"># X2</span>
         <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="co"># X3</span>
         <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span><span class="op">)</span> <span class="co"># X4</span>
<span class="va">rho_cormat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">4</span>, r <span class="op">=</span> <span class="va">rho</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">rho_cormat</span><span class="op">)</span>
<span class="co">##    n var  X1  X2  X3  X4 mean sd</span>
<span class="co">## 1 50  X1 1.0 0.5 0.4 0.3    0  1</span>
<span class="co">## 2 50  X2 0.5 1.0 0.2 0.1    0  1</span>
<span class="co">## 3 50  X3 0.4 0.2 1.0 0.0    0  1</span>
<span class="co">## 4 50  X4 0.3 0.1 0.0 1.0    0  1</span></code></pre></div>
<p>Alternatively, you can just specify the values from the upper right triangle of a correlation matrix. This is easier if you’re reading the values out of a paper.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># upper right triangle</span>
<span class="co">#         X2   X3   X4</span>
<span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="co"># X1</span>
              <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="co"># X2</span>
                   <span class="fl">0.0</span><span class="op">)</span> <span class="co"># X3</span>

<span class="va">rho_urt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">4</span>, r <span class="op">=</span> <span class="va">rho</span>, empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">rho_urt</span><span class="op">)</span>
<span class="co">##    n var  X1  X2  X3  X4 mean sd</span>
<span class="co">## 1 50  X1 1.0 0.5 0.4 0.3    0  1</span>
<span class="co">## 2 50  X2 0.5 1.0 0.2 0.1    0  1</span>
<span class="co">## 3 50  X3 0.4 0.2 1.0 0.0    0  1</span>
<span class="co">## 4 50  X4 0.3 0.1 0.0 1.0    0  1</span></code></pre></div>
</div>
</div>
<div id="factorial-designs" class="section level2">
<h2 class="hasAnchor">
<a href="#factorial-designs" class="anchor"></a>Factorial Designs</h2>
<p>You can use <code><a href="https://rdrr.io/pkg/faux/man/rnorm_multi.html">rnorm_multi()</a></code> to simulate data for each between-subjects cell of a factorial design and manually combine the tables, but faux has a function that better maps onto how we usually think and teach about factorial designs.</p>
<p>The default design is 100 observations of one variable (named <code>y</code>) with a mean of 0 and SD of 1. Unless you set <code>plot = FALSE</code> or run <code><a href="https://rdrr.io/pkg/faux/man/faux_options.html">faux_options(plot = FALSE)</a></code>, this function will show you a plot of your design so you can check that it looks like you expect.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simdat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
<div id="factors" class="section level3">
<h3 class="hasAnchor">
<a href="#factors" class="anchor"></a>Factors</h3>
<p>Use lists to set the names and levels of <code>within</code>- and <code>between</code>-subject factors.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
<p>You can set <code>mu</code> and <code>sd</code> with unnamed vectors, but getting the order right can take some trial and error.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  mu <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-13-1.png" width="100%"></p>
<p>You can set values with a named vector for a single type of factor. The values do not have to be in the right order if they’re named.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="fl">1</span>, ferret <span class="op">=</span> <span class="fl">5</span>, dog <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>pre <span class="op">=</span> <span class="fl">1</span>, post <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-14-1.png" width="100%"></p>
<p>Or use a data frame for within- and between-subject factors.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    pre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,
    post <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,
    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-15-1.png" width="100%"></p>
<p>If you have within-subject factors, set the correlations for each between-subject cell like this.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="fl">0.5</span>,
           dog <span class="op">=</span> <span class="fl">0.25</span>,
           ferret <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  empirical <span class="op">=</span> <span class="cn">TRUE</span>,
  plot <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">pettime</span><span class="op">)</span>
<span class="co">##      pet   n  var  pre post mean sd</span>
<span class="co">## 1    cat 100  pre 1.00 0.50    0  1</span>
<span class="co">## 2    cat 100 post 0.50 1.00    0  1</span>
<span class="co">## 3    dog 100  pre 1.00 0.25    0  1</span>
<span class="co">## 4    dog 100 post 0.25 1.00    0  1</span>
<span class="co">## 5 ferret 100  pre 1.00 0.00    0  1</span>
<span class="co">## 6 ferret 100 post 0.00 1.00    0  1</span></code></pre></div>
<p>You can also change the name of the <code>dv</code> and <code>id</code> columns and output the data in long format. If you do this, you also need to tell <code><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params()</a></code> what columns contain the between- and within-subject factors, the dv, and the id.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"ferret"</span><span class="op">)</span><span class="op">)</span>,
  id <span class="op">=</span> <span class="st">"subj_id"</span>,
  dv <span class="op">=</span> <span class="st">"score"</span>,
  long <span class="op">=</span> <span class="cn">TRUE</span>,
  plot <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/faux/man/get_params.html">get_params</a></span><span class="op">(</span><span class="va">dat_long</span>, 
           between <span class="op">=</span> <span class="st">"pet"</span>, 
           within <span class="op">=</span> <span class="st">"time"</span>,
           id <span class="op">=</span> <span class="st">"subj_id"</span>,
           dv <span class="op">=</span> <span class="st">"score"</span>,
           digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">##      pet   n  var   pre  post   mean    sd</span>
<span class="co">## 1    cat 100  pre 1.000 0.071 -0.001 1.120</span>
<span class="co">## 2    cat 100 post 0.071 1.000  0.036 0.875</span>
<span class="co">## 3    dog 100  pre 1.000 0.127 -0.036 1.081</span>
<span class="co">## 4    dog 100 post 0.127 1.000  0.065 0.976</span>
<span class="co">## 5 ferret 100  pre 1.000 0.075  0.072 0.967</span>
<span class="co">## 6 ferret 100 post 0.075 1.000  0.035 0.936</span></code></pre></div>
<p><em>The current version of faux doesn’t actually need <code>between</code> or <code>dv</code> and later versions won’t need <code>within</code> or <code>id</code> if a data frame was created with faux.</em></p>
</div>
<div id="anonymous-factors" class="section level3">
<h3 class="hasAnchor">
<a href="#anonymous-factors" class="anchor"></a>Anonymous Factors</h3>
<p>If you need to make a quick demo, you can set factors anonymously with integer vectors. For example, the following code makes 3B*2B*2W mixed design.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_anon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">50</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,
  within <span class="op">=</span> <span class="fl">2</span>,
  mu <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-18-1.png" width="100%"></p>
<p>Faux has a quick plotting function for visualising data made with faux. The plot created by <code><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design()</a></code> shows the <em>design</em>, while this function shows the simulated <em>data</em>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dat_anon</span><span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-19-1.png" width="100%"></p>
<p>You can change the order of plotting and the types of geoms plotted. This takes a little trial and error, so this function will probably be refined in later versions.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dat_anon</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"W1"</span>, geoms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"violin"</span>, <span class="st">"pointrangeSD"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-20-1.png" width="100%"></p>
</div>
</div>
<div id="replications" class="section level2">
<h2 class="hasAnchor">
<a href="#replications" class="anchor"></a>Replications</h2>
<p>You often want to simulate data repeatedly to do things like calculate power. The <code><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design()</a></code> function has a lot of overhead for checking if a design makes sense and if the correlation matrix is possible, so you can speed up the creation of multiple datasets with the same design using the <code>rep</code> argument. This will give you a nested data frame with each dataset in the <code>data</code> column.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fl">2</span>,
  n <span class="op">=</span> <span class="fl">20</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>,
  rep <span class="op">=</span> <span class="fl">5</span>,
  plot <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<div id="analyse-each-replicate" class="section level3">
<h3 class="hasAnchor">
<a href="#analyse-each-replicate" class="anchor"></a>Analyse each replicate</h3>
<p>You can run analyses on the nested data by wrapping your analysis code in a function then using <code>map()</code> to run the analysis on each data set and <code>unnest()</code> to expand the results into a data table.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">analyse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">W1a</span>, <span class="va">data</span><span class="op">$</span><span class="va">W1b</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">dat_rep</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>analysis <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="va">analyse</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest</span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span>
<span class="co">## # A tibble: 5 × 9</span>
<span class="co">##     rep estimate statistic p.value parameter conf.low conf.high method       </span>
<span class="co">##   &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;        </span>
<span class="co">## 1     1   -0.131    -0.427  0.674         19   -0.774    0.512  Paired t-test</span>
<span class="co">## 2     2   -0.268    -1.13   0.274         19   -0.768    0.231  Paired t-test</span>
<span class="co">## 3     3   -0.304    -0.908  0.375         19   -1.01     0.397  Paired t-test</span>
<span class="co">## 4     4   -0.550    -1.99   0.0607        19   -1.13     0.0273 Paired t-test</span>
<span class="co">## 5     5   -0.143    -0.487  0.632         19   -0.759    0.473  Paired t-test</span>
<span class="co">## # … with 1 more variable: alternative &lt;chr&gt;</span></code></pre></div>
</div>
<div id="anova" class="section level3">
<h3 class="hasAnchor">
<a href="#anova" class="anchor"></a>ANOVA</h3>
<p>Use the same pattern to run an ANOVA on a version of the <code>pettime</code> dataset.</p>
<p>First, simulate 100 datasets in long format. These data will have small main effects of pet and time, but no interaction.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span>,
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span><span class="op">)</span><span class="op">)</span>,
  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>cat <span class="op">=</span> <span class="fl">50</span>, dog <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    pre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.2</span><span class="op">)</span>,
    post <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.4</span><span class="op">)</span>,
    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="st">"dog"</span><span class="op">)</span>
  <span class="op">)</span>,
  sd <span class="op">=</span> <span class="fl">1</span>,
  id <span class="op">=</span> <span class="st">"pet_id"</span>,
  dv <span class="op">=</span> <span class="st">"score"</span>,
  r <span class="op">=</span> <span class="fl">0.5</span>,
  long <span class="op">=</span> <span class="cn">TRUE</span>,
  rep <span class="op">=</span> <span class="fl">100</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-23-1.png" width="100%"></p>
<p>Then set up your analysis. We’ll use the <code><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez()</a></code> function from the {afex} package because its arguments match those of <code><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design()</a></code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/set_sum_contrasts.html">set_sum_contrasts</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># avoids annoying afex message</span>
<span class="co">## setting contr.sum globally: options(contrasts=c('contr.sum', 'contr.poly'))</span>
<span class="fu"><a href="https://rdrr.io/pkg/afex/man/afex_options.html">afex_options</a></span><span class="op">(</span>include_aov <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># runs faster</span>
<span class="fu"><a href="https://rdrr.io/pkg/afex/man/afex_options.html">afex_options</a></span><span class="op">(</span>es_aov <span class="op">=</span> <span class="st">"pes"</span><span class="op">)</span> <span class="co"># changes effect size measure to partial eta squared</span>

<span class="va">analyse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>
    id <span class="op">=</span> <span class="st">"pet_id"</span>,
    dv <span class="op">=</span> <span class="st">"score"</span>,
    between <span class="op">=</span> <span class="st">"pet"</span>,
    within <span class="op">=</span> <span class="st">"time"</span>,
    data <span class="op">=</span> <span class="va">data</span>
  <span class="op">)</span> 
  <span class="co"># return anova_table for GG-corrected DF</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">anova_table</span>, rownames <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">term</span>, levels <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># keeps terms in order</span>
    <span class="fu">rename</span><span class="op">(</span>p.value <span class="op">=</span> <span class="va">`Pr(&gt;F)`</span><span class="op">)</span> <span class="co"># fixes annoying p.value name</span>
<span class="op">}</span></code></pre></div>
<p>Make a table of the results of each analysis:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime_sim</span> <span class="op">&lt;-</span> <span class="va">pettime100</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>analysis <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="va">analyse</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest</span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##     rep term     `num Df` `den Df`   MSE      F   pes p.value
##   &lt;int&gt; &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1     1 pet             1       88 1.42   0.667 0.008   0.416
## 2     1 time            1       88 0.534  0.544 0.006   0.463
## 3     1 pet:time        1       88 0.534  0.035 0       0.852
## 4     2 pet             1       88 1.18   2.44  0.027   0.122
## 5     2 time            1       88 0.498 11.0   0.111   0.001
## 6     2 pet:time        1       88 0.498  1.82  0.02    0.181</code></pre>
<p>Then you can summarise the data to calculate things like power for each effect or mean effect size.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pettime_sim</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>,
            mean_pes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pes</span><span class="op">)</span>,
            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span>
<span class="co">## # A tibble: 3 × 3</span>
<span class="co">##   term     power mean_pes</span>
<span class="co">##   &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">## 1 pet       0.15  0.0213 </span>
<span class="co">## 2 time      0.37  0.0424 </span>
<span class="co">## 3 pet:time  0.03  0.00898</span></code></pre></div>
<p>The power for the between-subjects effect of pet is smaller than for the within-subjects effect of time. What happens if you reduce the correlation between pre and post?</p>
</div>
</div>
<div id="exercises" class="section level2">
<h2 class="hasAnchor">
<a href="#exercises" class="anchor"></a>Exercises</h2>
<div id="multivariate-normal-1" class="section level3">
<h3 class="hasAnchor">
<a href="#multivariate-normal-1" class="anchor"></a>Multivariate normal</h3>
<p>Sample 40 values of three variables named <code>J</code>, <code>K</code> and <code>L</code> from a population with means of 10, 20 and 30, and SDs of 5. <code>J</code> and <code>K</code> are correlated 0.5, <code>J</code> and <code>L</code> are correlated 0.25, and <code>K</code> and <code>L</code> are not correlated.</p>
</div>
<div id="from-existing-data" class="section level3">
<h3 class="hasAnchor">
<a href="#from-existing-data" class="anchor"></a>From existing data</h3>
<p>Using the data from the built-in dataset <code>attitude</code>, simulate a new set of 20 observations drawn from a population with the same means, SDs and correlations for each column as the original data.</p>
</div>
<div id="b" class="section level3">
<h3 class="hasAnchor">
<a href="#b" class="anchor"></a>2b</h3>
<p>Create a dataset with a between-subject factor of “pet” having two levels, “cat”, and “dog”. The DV is “happiness” score. There are 20 cat-owners with a mean happiness score of 10 (SD = 3) and there are 30 dog-owners with a mean happiness score of 11 (SD = 3).</p>
</div>
<div id="w" class="section level3">
<h3 class="hasAnchor">
<a href="#w" class="anchor"></a>3w</h3>
<p>Create a dataset of 20 observations with 1 within-subject variable (“condition”) having 3 levels (“A”, “B”, “C”) with means of 10, 20 and 30 and SD of 5. The correlations between each level have r = 0.4. The dataset should look like this:</p>
<table class="table">
<thead><tr class="header">
<th align="left">id</th>
<th align="left">condition</th>
<th align="right">score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">S01</td>
<td align="left">A</td>
<td align="right">9.17</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
<tr class="odd">
<td align="left">S20</td>
<td align="left">A</td>
<td align="right">11.57</td>
</tr>
<tr class="even">
<td align="left">S01</td>
<td align="left">B</td>
<td align="right">18.44</td>
</tr>
<tr class="odd">
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
<tr class="even">
<td align="left">S20</td>
<td align="left">B</td>
<td align="right">20.04</td>
</tr>
<tr class="odd">
<td align="left">S01</td>
<td align="left">C</td>
<td align="right">35.11</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
<tr class="odd">
<td align="left">S20</td>
<td align="left">C</td>
<td align="right">29.16</td>
</tr>
</tbody>
</table>
</div>
<div id="w2w" class="section level3">
<h3 class="hasAnchor">
<a href="#w2w" class="anchor"></a>2w*2w</h3>
<p>Create a dataset with 50 observations of 2 within-subject variables (“W1” and “W2”) each having 2 levels. The mean for all cells is 10 and the SD is 2. The dataset should have 20 subjects. The correlations look like this:</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">W1a_W2a</th>
<th align="right">W1a_W2b</th>
<th align="right">W1b_W2a</th>
<th align="right">W1b_W2b</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">W1a_W2a</td>
<td align="right">1.0</td>
<td align="right">0.5</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="left">W1a_W2b</td>
<td align="right">0.5</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.5</td>
</tr>
<tr class="odd">
<td align="left">W1b_W2a</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">W1b_W2b</td>
<td align="right">0.2</td>
<td align="right">0.5</td>
<td align="right">0.5</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
</div>
<div id="w3b" class="section level3">
<h3 class="hasAnchor">
<a href="#w3b" class="anchor"></a>2w*3b</h3>
<p>Create a dataset with a between-subject factor of “pet” having 3 levels (“cat”, “dog”, and “ferret”) and a within-subject factor of “time” having 2 levels (“pre” and “post”). The N in each group should be 10. Means are:</p>
<ul>
<li>cats: pre = 10, post = 12</li>
<li>dogs: pre = 14, post = 16</li>
<li>ferrets: pre = 18, post = 20</li>
</ul>
<p>SDs are all 5 and within-cell correlations are all 0.25.</p>
</div>
<div id="replications-1" class="section level3">
<h3 class="hasAnchor">
<a href="#replications-1" class="anchor"></a>Replications</h3>
<p>Create 5 datasets with a 2b*2b design, 30 participants in each cell. Each cell’s mean should be 0, except B1a:B2a, which should be 0.5. The SD should be 1. Make the resulting data in long format.</p>
</div>
<div id="power" class="section level3">
<h3 class="hasAnchor">
<a href="#power" class="anchor"></a>Power</h3>
<p>Simulate 100 datasets like the one above and use <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> or <code><a href="https://rdrr.io/pkg/afex/man/aov_car.html">afex::aov_ez()</a></code> to look at the interaction between A and B. What is the power of this design?</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># simulate 100 datasets</span>
<span class="va">dat2b2b_100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
  between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
  n <span class="op">=</span> <span class="fl">30</span>,
  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
  rep <span class="op">=</span> <span class="fl">100</span>,
  long <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<p><img src="faux_files/figure-html/unnamed-chunk-35-1.png" width="100%"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># linear model version</span>
<span class="va">analyse_lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">B1</span><span class="op">*</span><span class="va">B2</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">term</span>, levels <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">ana_lm</span> <span class="op">&lt;-</span> <span class="va">dat2b2b_100</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>analysis <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="va">analyse_lm</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest</span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span>

<span class="va">ana_lm</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">.05</span><span class="op">)</span>,
            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span>
<span class="co">## # A tibble: 4 × 2</span>
<span class="co">##   term        power</span>
<span class="co">##   &lt;fct&gt;       &lt;dbl&gt;</span>
<span class="co">## 1 (Intercept)  0.21</span>
<span class="co">## 2 B11          0.23</span>
<span class="co">## 3 B21          0.25</span>
<span class="co">## 4 B11:B21      0.32</span>

<span class="co"># anova version</span>
<span class="va">analyse_aov</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"id"</span>,
              dv <span class="op">=</span> <span class="st">"y"</span>,
              between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span>,
              data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>
  
  <span class="fu">as_tibble</span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">anova_table</span>, rownames <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">term</span>, levels <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">rename</span><span class="op">(</span>p.value <span class="op">=</span> <span class="va">`Pr(&gt;F)`</span><span class="op">)</span> 
<span class="op">}</span>

<span class="va">ana_aov</span> <span class="op">&lt;-</span> <span class="va">dat2b2b_100</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>analysis <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="va">analyse_aov</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest</span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span>

<span class="va">ana_aov</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">.05</span><span class="op">)</span>,
            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span>
<span class="co">## # A tibble: 3 × 2</span>
<span class="co">##   term  power</span>
<span class="co">##   &lt;fct&gt; &lt;dbl&gt;</span>
<span class="co">## 1 B1     0.23</span>
<span class="co">## 2 B2     0.25</span>
<span class="co">## 3 B1:B2  0.32</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lisa DeBruine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
